import{d as q,r as D,a as $,w as te,b as r,c as k,o as f,n as ne,e as o,f as s,_ as H,g as I,h as c,i as N,F as M,j as z,s as oe,L as h,k as ue,l as x,t as S,m as g}from"./index-DVsbxhji.js";import{s as se}from"./data-BCZFxGvg.js";const re=q({__name:"Date",props:{defaultDate:{},clearable:{type:Boolean,default:!1},className:{},placeholder:{}},emits:["dateChange"],setup(P,{emit:d}){const t=D(),u=D(!1),y=D($(new Date).format("YYYY-MM-DD").split("-")),Y=d,l=P,b=m=>{y.value=m.selectedValues,t.value=m.selectedValues.join("-"),u.value=!1,Y("dateChange",t.value)};te(()=>l.defaultDate,()=>{const{defaultDate:m}=l;m&&(y.value=(m||$(new Date).format("YYYY-MM-DD")).split("-"),t.value=m)},{immediate:!0});const U=()=>{y.value=$(new Date).format("YYYY-MM-DD").split("-"),t.value=""};return(m,v)=>{const V=r("van-field"),C=r("van-date-picker"),T=r("van-popup");return f(),k("div",{class:ne(m.className)},[o(V,{readonly:"",clickable:"",modelValue:t.value,"onUpdate:modelValue":v[0]||(v[0]=w=>t.value=w),placeholder:m.placeholder,"right-icon":m.clearable&&t.value?"cross":"",onClickInput:v[1]||(v[1]=w=>u.value=!0),onClickRightIcon:U},null,8,["modelValue","placeholder","right-icon"]),o(T,{show:u.value,"onUpdate:show":v[4]||(v[4]=w=>u.value=w),position:"bottom"},{default:s(()=>[o(C,{modelValue:y.value,"onUpdate:modelValue":v[2]||(v[2]=w=>y.value=w),onConfirm:b,onCancel:v[3]||(v[3]=w=>u.value=!1)},null,8,["modelValue"])]),_:1},8,["show"])],2)}}}),de=H(re,[["__scopeId","data-v-0eb89f07"]]),me={style:{padding:"2%"}},ve={class:"flex-wrap"},ie={class:"back-gauge"},pe={key:0,class:"flex-row",style:{width:"98%",margin:"10px 1%"}},fe={key:1,class:"flex-row",style:{width:"98%",margin:"10px 1%"}},ce={class:"shadow",style:{margin:"1%"}},he={class:"flex-row P6"},we={class:"MX6 FS15"},_e={class:"align-center MT10 FS14"},ye={class:"P24"},ge={class:"P24"},ke=q({__name:"Home",setup(P){const d=D(!1),t=D([]),u=D({show:!1,dataStr:"",placeholder:""}),y=a=>{u.value.placeholder=a,u.value.show=!0},Y=()=>{const a=JSON.parse(u.value.dataStr);u.value.placeholder==="备料"&&h.data.setter(a),u.value.placeholder==="订单"&&h.orderData.setter(a),O(),u.value.show=!1,d.value=!1},l=D({type:"add",show:!1,form:{},data:[],monthData:[],index:0,checkedMonth:""}),b=I(()=>{const a=l.value.checkedMonth;return a?l.value.data.filter(e=>e.orderDate.substring(0,7)===a):l.value.data}),U=a=>{switch(a){case"2.0":l.value.form.value=70;break;case"3.0":l.value.form.value=80;break}l.value.form.orderDate=$(new Date).format("YYYY-MM-DD")},m=a=>l.value.checkedMonth=l.value.checkedMonth===a?"":a,v=a=>{l.value.form.orderDate=a},V=(a,e)=>{navigator.clipboard.writeText(JSON.stringify(a)),oe(`${e}数据复制成功`)},C=()=>{const a={};for(let i of l.value.data)if(i.orderDate){const p=i.orderDate.substring(0,7);a[p]?a[p]+=Number(i.value):a[p]=Number(i.value)}const e=[];for(let i in a)e.push({month:i,value:a[i]});l.value.monthData=e},T=I(()=>a=>a.reduce((e,i)=>e+Number(i.value),0)),w=I(()=>a=>a.num===0?{backgroundColor:"#E47471",color:"#ffffff"}:a.num>0&&a.num<=a.warnNum?{backgroundColor:"#DCA551",color:"#ffffff"}:{}),J=()=>{d.value&&h.data.setter(t.value),d.value=!d.value},B=D(!0),R=()=>{const a=l.value.type;if(a==="add"&&(B.value&&(l.value.form.title==="2.0"&&t.value.forEach(e=>{e.name==="风扇"&&(e.num-=1),e.name==="塑料盒"&&(e.num-=2),e.name==="钢丝软管"&&(e.num-=2),e.name==="直法兰"&&(e.num-=1),e.name==="2.0包装箱"&&(e.num-=1),e.name==="2.0饮料瓶"&&(e.num-=1)}),l.value.form.title==="3.0"&&t.value.forEach(e=>{e.name==="风扇"&&(e.num-=1),e.name==="塑料盒"&&(e.num-=1),e.name==="直法兰"&&(e.num-=1),e.name==="花瓶"&&(e.num-=1),e.name==="90度弯头"&&(e.num-=3),e.name==="45度弯头"&&(e.num-=1),e.name==="50管"&&(e.num-=1),e.name==="内50软管"&&(e.num-=1),e.name==="6型号盖"&&(e.num-=1),e.name==="3.0矿泉水桶"&&(e.num-=1),e.name==="3.0吸管"&&(e.num-=1)}),h.data.setter(t.value)),l.value.data.unshift(l.value.form)),a==="upd"){const e=l.value.index;e>=0&&l.value.data.splice(e,1,l.value.form)}l.value.show=!1,h.orderData.setter(l.value.data),l.value.form={},C()},W=(a,e)=>{l.value.type="upd",l.value.index=e,l.value.form={...a},l.value.show=!0},A=a=>{l.value.data.splice(a,1),h.orderData.setter(l.value.data),C()},O=()=>{h.data.getter()&&(t.value=h.data.getter()),t.value.some(a=>a.name==="风扇")||t.value.push({name:"风扇",num:0,warnNum:2}),t.value.some(a=>a.name==="塑料盒")||t.value.push({name:"塑料盒",num:0,warnNum:5}),t.value.some(a=>a.name==="钢丝软管")||t.value.push({name:"钢丝软管",num:0,warnNum:4}),t.value.some(a=>a.name==="直法兰")||t.value.push({name:"直法兰",num:0,warnNum:2}),t.value.some(a=>a.name==="2.0包装箱")||t.value.push({name:"2.0包装箱",num:0,warnNum:2}),t.value.some(a=>a.name==="2.0饮料瓶")||t.value.push({name:"2.0饮料瓶",num:0,warnNum:2}),t.value.some(a=>a.name==="花瓶")||t.value.push({name:"花瓶",num:0,warnNum:1}),t.value.some(a=>a.name==="6型号盖")||t.value.push({name:"6型号盖",num:0,warnNum:1}),t.value.some(a=>a.name==="90度弯头")||t.value.push({name:"90度弯头",num:0,warnNum:3}),t.value.some(a=>a.name==="45度弯头")||t.value.push({name:"45度弯头",num:0,warnNum:1}),t.value.some(a=>a.name==="50管")||t.value.push({name:"50管",num:0,warnNum:1}),t.value.some(a=>a.name==="内50软管")||t.value.push({name:"内50软管",num:0,warnNum:1}),t.value.some(a=>a.name==="3.0矿泉水桶")||t.value.push({name:"3.0矿泉水桶",num:0,warnNum:1}),t.value.some(a=>a.name==="3.0吸管")||t.value.push({name:"3.0吸管",num:0,warnNum:1}),h.orderData.getter()&&(l.value.data=se(h.orderData.getter(),"desc","orderDate")),C()};return O(),(a,e)=>{const i=r("el-input-number"),p=r("el-button"),X=r("el-check-tag"),E=r("van-cell"),F=r("van-button"),G=r("van-swipe-cell"),K=r("van-cell-group"),j=r("el-radio-button"),Q=r("el-radio-group"),Z=r("van-field"),ee=r("el-switch"),L=r("van-popup"),ae=r("el-input");return f(),k(M,null,[c("div",me,[c("div",ve,[(f(!0),k(M,null,z(t.value,n=>(f(),k("div",{class:"shadow BR5",key:n.index,style:ue([w.value(n),{width:"44%",margin:"1%",padding:"2%"}])},[c("h4",ie,S(n.name),1),o(i,{class:"MT6 W100",disabled:!d.value,modelValue:n.num,"onUpdate:modelValue":_=>n.num=_,min:0,max:1e4},null,8,["disabled","modelValue","onUpdate:modelValue"]),d.value?(f(),x(i,{key:0,class:"MT6 W100",modelValue:n.warnNum,"onUpdate:modelValue":_=>n.warnNum=_,min:0,max:1e4},null,8,["modelValue","onUpdate:modelValue"])):N("",!0)],4))),128))]),d.value?(f(),k("div",pe,[o(p,{type:"success",style:{flex:"1"},onClick:e[0]||(e[0]=n=>V(t.value,"备料"))},{default:s(()=>[...e[11]||(e[11]=[g("复制备料数据",-1)])]),_:1}),o(p,{type:"success",style:{flex:"1"},onClick:e[1]||(e[1]=n=>V(l.value.data,"订单"))},{default:s(()=>[...e[12]||(e[12]=[g("复制订单数据",-1)])]),_:1})])):N("",!0),d.value?(f(),k("div",fe,[o(p,{type:"primary",style:{flex:"1"},onClick:e[2]||(e[2]=n=>y("备料"))},{default:s(()=>[...e[13]||(e[13]=[g("导入备料数据",-1)])]),_:1}),o(p,{type:"primary",style:{flex:"1"},onClick:e[3]||(e[3]=n=>y("订单"))},{default:s(()=>[...e[14]||(e[14]=[g("导入订单数据",-1)])]),_:1})])):N("",!0),o(p,{style:{width:"98%",margin:"20px 1%"},size:"large",type:d.value?"primary":"success",onClick:J},{default:s(()=>[g(S(d.value?"保存":"调整"),1)]),_:1},8,["type"]),c("div",ce,[c("div",he,[(f(!0),k(M,null,z(l.value.monthData,n=>(f(),x(X,{key:n.month,checked:l.value.checkedMonth===n.month,class:"M6 P6",onChange:_=>m(n.month)},{default:s(()=>[c("div",we,S(n.month),1),c("div",_e,S(n.value),1)]),_:2},1032,["checked","onChange"]))),128))]),o(K,null,{default:s(()=>[o(E,{value:`合计 ${T.value(b.value)}`},{title:s(()=>[o(p,{size:"small",type:"primary",text:"",bg:"",onClick:e[4]||(e[4]=n=>l.value.show=!0)},{default:s(()=>[...e[15]||(e[15]=[g("新增",-1)])]),_:1})]),_:1},8,["value"]),(f(!0),k(M,null,z(b.value,(n,_)=>(f(),x(G,{key:_},{right:s(()=>[o(F,{square:"",type:"primary",style:{height:"100%"},text:"编辑",onClick:le=>W(n,_)},null,8,["onClick"]),o(F,{square:"",type:"danger",style:{height:"100%"},text:"删除",onClick:le=>A(_)},null,8,["onClick"])]),default:s(()=>[o(E,{title:`${b.value.length-_}：吸尘器${n.title}`,label:n.orderDate,value:`收入 ${n.value}`},null,8,["title","label","value"])]),_:2},1024))),128))]),_:1})])]),e[18]||(e[18]=c("div",{style:{height:"25vh"}},null,-1)),o(L,{show:l.value.show,"onUpdate:show":e[8]||(e[8]=n=>l.value.show=n),position:"bottom","destroy-on-close":""},{default:s(()=>[c("div",ye,[o(Q,{modelValue:l.value.form.title,"onUpdate:modelValue":e[5]||(e[5]=n=>l.value.form.title=n),class:"MB15",onChange:U},{default:s(()=>[o(j,{label:"2.0",value:"2.0"}),o(j,{label:"3.0",value:"3.0"})]),_:1},8,["modelValue"]),o(Z,{modelValue:l.value.form.value,"onUpdate:modelValue":e[6]||(e[6]=n=>l.value.form.value=n),type:"digit",placeholder:"收入",clearable:""},null,8,["modelValue"]),o(de,{class:"MT15",placeholder:"下单日期","default-date":l.value.form.orderDate,onDateChange:v},null,8,["default-date"]),l.value.type==="add"?(f(),x(ee,{key:0,modelValue:B.value,"onUpdate:modelValue":e[7]||(e[7]=n=>B.value=n),"active-text":"计算备料",class:"MT15"},null,8,["modelValue"])):N("",!0),o(p,{type:"primary",size:"large",style:{width:"100%"},onClick:R,class:"MT50",disabled:!(l.value.form.title&&l.value.form.value)},{default:s(()=>[...e[16]||(e[16]=[g(" 提交 ",-1)])]),_:1},8,["disabled"])])]),_:1},8,["show"]),o(L,{show:u.value.show,"onUpdate:show":e[10]||(e[10]=n=>u.value.show=n),position:"bottom","destroy-on-close":""},{default:s(()=>[c("div",ge,[o(ae,{modelValue:u.value.dataStr,"onUpdate:modelValue":e[9]||(e[9]=n=>u.value.dataStr=n),placeholder:`请导入${u.value.placeholder}数据`,rows:6,type:"textarea"},null,8,["modelValue","placeholder"]),o(p,{type:"primary",size:"large",style:{width:"100%"},onClick:Y,class:"MT50",disabled:!u.value.dataStr},{default:s(()=>[...e[17]||(e[17]=[g(" 提交 ",-1)])]),_:1},8,["disabled"])])]),_:1},8,["show"])],64)}}}),Ce=H(ke,[["__scopeId","data-v-cae88788"]]);export{Ce as default};
