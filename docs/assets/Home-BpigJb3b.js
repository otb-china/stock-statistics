import{d as H,r as D,a as Y,w as ne,b as r,c as y,o as d,n as oe,e as o,f as s,_ as J,g as P,h as f,i as N,F as M,j as z,s as ue,L as c,k as se,t as x,l as $,m as w}from"./index-DLe4yeew.js";import{s as re}from"./data-BCZFxGvg.js";const de=H({__name:"Date",props:{defaultDate:{},clearable:{type:Boolean,default:!1},className:{},placeholder:{}},emits:["dateChange"],setup(F,{emit:m}){const t=D(),u=D(!1),g=D(Y(new Date).format("YYYY-MM-DD").split("-")),U=m,l=F,C=v=>{g.value=v.selectedValues,t.value=v.selectedValues.join("-"),u.value=!1,U("dateChange",t.value)};ne(()=>l.defaultDate,()=>{const{defaultDate:v}=l;v&&(g.value=(v||Y(new Date).format("YYYY-MM-DD")).split("-"),t.value=v)},{immediate:!0});const T=()=>{g.value=Y(new Date).format("YYYY-MM-DD").split("-"),t.value=""};return(v,i)=>{const S=r("van-field"),V=r("van-date-picker"),B=r("van-popup");return d(),y("div",{class:oe(v.className)},[o(S,{readonly:"",clickable:"",modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=h=>t.value=h),placeholder:v.placeholder,"right-icon":v.clearable&&t.value?"cross":"",onClickInput:i[1]||(i[1]=h=>u.value=!0),onClickRightIcon:T},null,8,["modelValue","placeholder","right-icon"]),o(B,{show:u.value,"onUpdate:show":i[4]||(i[4]=h=>u.value=h),position:"bottom"},{default:s(()=>[o(V,{modelValue:g.value,"onUpdate:modelValue":i[2]||(i[2]=h=>g.value=h),onConfirm:C,onCancel:i[3]||(i[3]=h=>u.value=!1)},null,8,["modelValue"])]),_:1},8,["show"])],2)}}}),me=J(de,[["__scopeId","data-v-0eb89f07"]]),ve={style:{padding:"2%"}},ie={class:"flex-wrap"},pe={class:"back-gauge"},fe={class:"align-right"},ce={key:0,class:"flex-row",style:{width:"98%",margin:"10px 1%"}},he={key:1,class:"flex-row",style:{width:"98%",margin:"10px 1%"}},_e={class:"shadow",style:{margin:"1%"}},we={class:"flex-row P6"},ye={class:"MX6 FS15"},ge={class:"align-center MT10 FS14"},ke={class:"P24"},De={class:"P24"},be=H({__name:"Home",setup(F){const m=D(!1),t=D([]),u=D({show:!1,dataStr:"",placeholder:""}),g=a=>{u.value.placeholder=a,u.value.show=!0},U=()=>{const a=JSON.parse(u.value.dataStr);u.value.placeholder==="备料"&&c.data.setter(a),u.value.placeholder==="订单"&&c.orderData.setter(a),O(),u.value.show=!1,m.value=!1},l=D({type:"add",show:!1,form:{},data:[],monthData:[],index:0,checkedMonth:""}),C=P(()=>{const a=l.value.checkedMonth;return a?l.value.data.filter(e=>e.orderDate.substring(0,7)===a):l.value.data}),T=a=>{switch(a){case"2.0":l.value.form.value=70;break;case"3.0":l.value.form.value=80;break}l.value.form.orderDate=Y(new Date).format("YYYY-MM-DD")},v=a=>l.value.checkedMonth=l.value.checkedMonth===a?"":a,i=a=>{l.value.form.orderDate=a},S=(a,e)=>{navigator.clipboard.writeText(JSON.stringify(a)),ue(`${e}数据复制成功`)},V=()=>{const a={};for(let p of l.value.data)if(p.orderDate){const b=p.orderDate.substring(0,7);a[b]?a[b]+=Number(p.value):a[b]=Number(p.value)}const e=[];for(let p in a)e.push({month:p,value:a[p]});l.value.monthData=e},B=P(()=>a=>a.reduce((e,p)=>e+Number(p.value),0)),h=P(()=>a=>a.num-a.warnNum<0?{backgroundColor:"#E47471",color:"#ffffff"}:a.num>0&&a.num<=a.warnNum?{backgroundColor:"#DCA551",color:"#ffffff"}:{}),R=()=>{m.value&&c.data.setter(t.value),m.value=!m.value},I=D(!0),W=()=>{const a=l.value.type;if(a==="add"&&(I.value&&(l.value.form.title==="2.0"&&t.value.forEach(e=>{e.name==="风扇"&&(e.num-=1),e.name==="塑料盒"&&(e.num-=2),e.name==="钢丝软管"&&(e.num-=2),e.name==="直法兰"&&(e.num-=1),e.name==="2.0包装箱"&&(e.num-=1),e.name==="2.0饮料瓶"&&(e.num-=1)}),l.value.form.title==="3.0"&&t.value.forEach(e=>{e.name==="风扇"&&(e.num-=1),e.name==="塑料盒"&&(e.num-=1),e.name==="直法兰"&&(e.num-=1),e.name==="花瓶"&&(e.num-=1),e.name==="90度弯头"&&(e.num-=3),e.name==="45度弯头"&&(e.num-=1),e.name==="50管"&&(e.num-=1),e.name==="内50软管"&&(e.num-=1),e.name==="6型号盖"&&(e.num-=1),e.name==="3.0矿泉水桶"&&(e.num-=1),e.name==="3.0吸管"&&(e.num-=1)}),c.data.setter(t.value)),l.value.data.unshift(l.value.form)),a==="upd"){const e=l.value.index;e>=0&&l.value.data.splice(e,1,l.value.form)}l.value.show=!1,c.orderData.setter(l.value.data),l.value.form={},V()},A=(a,e)=>{l.value.type="upd",l.value.index=e,l.value.form={...a},l.value.show=!0},X=a=>{l.value.data.splice(a,1),c.orderData.setter(l.value.data),V()},O=()=>{c.data.getter()&&(t.value=c.data.getter()),t.value.some(a=>a.name==="风扇")||t.value.push({name:"风扇",num:0,warnNum:2}),t.value.some(a=>a.name==="塑料盒")||t.value.push({name:"塑料盒",num:0,warnNum:5}),t.value.some(a=>a.name==="钢丝软管")||t.value.push({name:"钢丝软管",num:0,warnNum:4}),t.value.some(a=>a.name==="直法兰")||t.value.push({name:"直法兰",num:0,warnNum:2}),t.value.some(a=>a.name==="2.0包装箱")||t.value.push({name:"2.0包装箱",num:0,warnNum:2}),t.value.some(a=>a.name==="2.0饮料瓶")||t.value.push({name:"2.0饮料瓶",num:0,warnNum:2}),t.value.some(a=>a.name==="花瓶")||t.value.push({name:"花瓶",num:0,warnNum:1}),t.value.some(a=>a.name==="6型号盖")||t.value.push({name:"6型号盖",num:0,warnNum:1}),t.value.some(a=>a.name==="90度弯头")||t.value.push({name:"90度弯头",num:0,warnNum:3}),t.value.some(a=>a.name==="45度弯头")||t.value.push({name:"45度弯头",num:0,warnNum:1}),t.value.some(a=>a.name==="50管")||t.value.push({name:"50管",num:0,warnNum:1}),t.value.some(a=>a.name==="内50软管")||t.value.push({name:"内50软管",num:0,warnNum:1}),t.value.some(a=>a.name==="3.0矿泉水桶")||t.value.push({name:"3.0矿泉水桶",num:0,warnNum:1}),t.value.some(a=>a.name==="3.0吸管")||t.value.push({name:"3.0吸管",num:0,warnNum:1}),c.orderData.getter()&&(l.value.data=re(c.orderData.getter(),"desc","orderDate")),V()};return O(),(a,e)=>{const p=r("el-tag"),b=r("el-input-number"),k=r("el-button"),G=r("el-check-tag"),E=r("van-cell"),j=r("van-button"),K=r("van-swipe-cell"),Q=r("van-cell-group"),L=r("el-radio-button"),Z=r("el-radio-group"),ee=r("van-field"),ae=r("el-switch"),q=r("van-popup"),le=r("el-input");return d(),y(M,null,[f("div",ve,[f("div",ie,[(d(!0),y(M,null,z(t.value,n=>(d(),y("div",{class:"shadow BR5",key:n.index,style:se([h.value(n),{width:"44%",margin:"1%",padding:"2%"}])},[f("h4",pe,x(n.name),1),f("div",fe,[m.value?N("",!0):(d(),$(p,{key:0,type:"success",class:"P6 FS16"},{default:s(()=>[w(x(n.num),1)]),_:2},1024)),m.value?(d(),y(M,{key:1},[o(b,{class:"MT6 W100",modelValue:n.num,"onUpdate:modelValue":_=>n.num=_,min:0,max:1e4},null,8,["modelValue","onUpdate:modelValue"]),o(b,{class:"MT6 W100",modelValue:n.warnNum,"onUpdate:modelValue":_=>n.warnNum=_,min:0,max:1e4},null,8,["modelValue","onUpdate:modelValue"])],64)):N("",!0)])],4))),128))]),m.value?(d(),y("div",ce,[o(k,{type:"success",style:{flex:"1"},onClick:e[0]||(e[0]=n=>S(t.value,"备料"))},{default:s(()=>[...e[11]||(e[11]=[w("复制备料数据",-1)])]),_:1}),o(k,{type:"success",style:{flex:"1"},onClick:e[1]||(e[1]=n=>S(l.value.data,"订单"))},{default:s(()=>[...e[12]||(e[12]=[w("复制订单数据",-1)])]),_:1})])):N("",!0),m.value?(d(),y("div",he,[o(k,{type:"primary",style:{flex:"1"},onClick:e[2]||(e[2]=n=>g("备料"))},{default:s(()=>[...e[13]||(e[13]=[w("导入备料数据",-1)])]),_:1}),o(k,{type:"primary",style:{flex:"1"},onClick:e[3]||(e[3]=n=>g("订单"))},{default:s(()=>[...e[14]||(e[14]=[w("导入订单数据",-1)])]),_:1})])):N("",!0),o(k,{style:{width:"98%",margin:"20px 1%"},size:"large",type:m.value?"primary":"success",onClick:R},{default:s(()=>[w(x(m.value?"保存":"调整"),1)]),_:1},8,["type"]),f("div",_e,[f("div",we,[(d(!0),y(M,null,z(l.value.monthData,n=>(d(),$(G,{key:n.month,checked:l.value.checkedMonth===n.month,class:"M6 P6",onChange:_=>v(n.month)},{default:s(()=>[f("div",ye,x(n.month),1),f("div",ge,x(n.value),1)]),_:2},1032,["checked","onChange"]))),128))]),o(Q,null,{default:s(()=>[o(E,{value:`合计 ${B.value(C.value)}`},{title:s(()=>[o(k,{size:"small",type:"primary",text:"",bg:"",onClick:e[4]||(e[4]=n=>l.value.show=!0)},{default:s(()=>[...e[15]||(e[15]=[w("新增",-1)])]),_:1})]),_:1},8,["value"]),(d(!0),y(M,null,z(C.value,(n,_)=>(d(),$(K,{key:_},{right:s(()=>[o(j,{square:"",type:"primary",style:{height:"100%"},text:"编辑",onClick:te=>A(n,_)},null,8,["onClick"]),o(j,{square:"",type:"danger",style:{height:"100%"},text:"删除",onClick:te=>X(_)},null,8,["onClick"])]),default:s(()=>[o(E,{title:`${C.value.length-_}：吸尘器${n.title}`,label:n.orderDate,value:`收入 ${n.value}`},null,8,["title","label","value"])]),_:2},1024))),128))]),_:1})])]),e[18]||(e[18]=f("div",{style:{height:"25vh"}},null,-1)),o(q,{show:l.value.show,"onUpdate:show":e[8]||(e[8]=n=>l.value.show=n),position:"bottom","destroy-on-close":""},{default:s(()=>[f("div",ke,[o(Z,{modelValue:l.value.form.title,"onUpdate:modelValue":e[5]||(e[5]=n=>l.value.form.title=n),class:"MB15",onChange:T},{default:s(()=>[o(L,{label:"2.0",value:"2.0"}),o(L,{label:"3.0",value:"3.0"})]),_:1},8,["modelValue"]),o(ee,{modelValue:l.value.form.value,"onUpdate:modelValue":e[6]||(e[6]=n=>l.value.form.value=n),type:"digit",placeholder:"收入",clearable:""},null,8,["modelValue"]),o(me,{class:"MT15",placeholder:"下单日期","default-date":l.value.form.orderDate,onDateChange:i},null,8,["default-date"]),l.value.type==="add"?(d(),$(ae,{key:0,modelValue:I.value,"onUpdate:modelValue":e[7]||(e[7]=n=>I.value=n),"active-text":"计算备料",class:"MT15"},null,8,["modelValue"])):N("",!0),o(k,{type:"primary",size:"large",style:{width:"100%"},onClick:W,class:"MT50",disabled:!(l.value.form.title&&l.value.form.value)},{default:s(()=>[...e[16]||(e[16]=[w(" 提交 ",-1)])]),_:1},8,["disabled"])])]),_:1},8,["show"]),o(q,{show:u.value.show,"onUpdate:show":e[10]||(e[10]=n=>u.value.show=n),position:"bottom","destroy-on-close":""},{default:s(()=>[f("div",De,[o(le,{modelValue:u.value.dataStr,"onUpdate:modelValue":e[9]||(e[9]=n=>u.value.dataStr=n),placeholder:`请导入${u.value.placeholder}数据`,rows:6,type:"textarea"},null,8,["modelValue","placeholder"]),o(k,{type:"primary",size:"large",style:{width:"100%"},onClick:U,class:"MT50",disabled:!u.value.dataStr},{default:s(()=>[...e[17]||(e[17]=[w(" 提交 ",-1)])]),_:1},8,["disabled"])])]),_:1},8,["show"])],64)}}}),Ne=J(be,[["__scopeId","data-v-86883a80"]]);export{Ne as default};
