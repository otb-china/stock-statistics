import{d as L,r as b,a as N,w as ee,b as r,c as h,o as p,n as ae,e as n,f as s,_ as q,g as j,h as w,i as k,F as V,j as T,s as le,L as y,k as te,l as B,t as C,m as D}from"./index-9nXa33x8.js";import{s as oe}from"./data-BCZFxGvg.js";const ne=L({__name:"Date",props:{defaultDate:{},clearable:{type:Boolean,default:!1},className:{},placeholder:{}},emits:["dateChange"],setup(I,{emit:v}){const l=b(),u=b(!1),_=b(N(new Date).format("YYYY-MM-DD").split("-")),x=v,t=I,M=m=>{_.value=m.selectedValues,l.value=m.selectedValues.join("-"),u.value=!1,x("dateChange",l.value)};ee(()=>t.defaultDate,()=>{const{defaultDate:m}=t;m&&(_.value=(m||N(new Date).format("YYYY-MM-DD")).split("-"),l.value=m)},{immediate:!0});const S=()=>{_.value=N(new Date).format("YYYY-MM-DD").split("-"),l.value=""};return(m,d)=>{const Y=r("van-field"),$=r("van-date-picker"),U=r("van-popup");return p(),h("div",{class:ae(m.className)},[n(Y,{readonly:"",clickable:"",modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=f=>l.value=f),placeholder:m.placeholder,"right-icon":m.clearable&&l.value?"cross":"",onClickInput:d[1]||(d[1]=f=>u.value=!0),onClickRightIcon:S},null,8,["modelValue","placeholder","right-icon"]),n(U,{show:u.value,"onUpdate:show":d[4]||(d[4]=f=>u.value=f),position:"bottom"},{default:s(()=>[n($,{modelValue:_.value,"onUpdate:modelValue":d[2]||(d[2]=f=>_.value=f),onConfirm:M,onCancel:d[3]||(d[3]=f=>u.value=!1)},null,8,["modelValue"])]),_:1},8,["show"])],2)}}}),ue=q(ne,[["__scopeId","data-v-0eb89f07"]]),se={style:{padding:"2%"}},re={class:"flex-wrap"},de={class:"back-gauge"},me={key:0,class:"flex-row",style:{width:"98%",margin:"10px 1%"}},ve={key:1,class:"flex-row",style:{width:"98%",margin:"10px 1%"}},ie={class:"shadow",style:{margin:"1%"}},pe={class:"flex-row P6"},fe={class:"MX6 FS15"},ce={class:"align-center MT10 FS14"},we={class:"P24"},ye={class:"P24"},he=L({__name:"Home",setup(I){const v=b(!1),l=b([]),u=b({show:!1,dataStr:"",placeholder:""}),_=a=>{u.value.placeholder=a,u.value.show=!0},x=()=>{const a=JSON.parse(u.value.dataStr);u.value.placeholder==="备料"&&y.data.setter(a),u.value.placeholder==="订单"&&y.orderData.setter(a),z(),u.value.show=!1,v.value=!1},t=b({type:"add",show:!1,form:{},data:[],monthData:[],index:0}),M=a=>{switch(a){case"2.0":t.value.form.value=70;break;case"3.0":t.value.form.value=80;break}t.value.form.orderDate=N(new Date).format("YYYY-MM-DD")},S=a=>{t.value.form.orderDate=a},m=(a,e)=>{navigator.clipboard.writeText(JSON.stringify(a)),le(`${e}数据复制成功`)},d=()=>{const a={};for(let c of t.value.data)if(c.orderDate){const i=c.orderDate.substring(0,7);a[i]?a[i]+=Number(c.value):a[i]=Number(c.value)}const e=[];for(let c in a)e.push({month:c,value:a[c]});t.value.monthData=e},Y=j(()=>t.value.data.reduce((a,e)=>a+Number(e.value),0)),$=j(()=>a=>a.num===0?{backgroundColor:"#E47471",color:"#ffffff"}:a.num>0&&a.num<=a.warnNum?{backgroundColor:"#DCA551",color:"#ffffff"}:{}),U=()=>{v.value&&y.data.setter(l.value),v.value=!v.value},f=b(!0),H=()=>{const a=t.value.type;if(a==="add"&&(f.value&&(t.value.form.title==="2.0"&&l.value.forEach(e=>{e.name==="风扇"&&(e.num-=1),e.name==="塑料盒"&&(e.num-=2),e.name==="钢丝软管"&&(e.num-=2),e.name==="直法兰"&&(e.num-=1),e.name==="2.0包装箱"&&(e.num-=1),e.name==="2.0饮料瓶"&&(e.num-=1)}),t.value.form.title==="3.0"&&l.value.forEach(e=>{e.name==="风扇"&&(e.num-=1),e.name==="塑料盒"&&(e.num-=1),e.name==="直法兰"&&(e.num-=1),e.name==="花瓶"&&(e.num-=1),e.name==="90度弯头"&&(e.num-=3),e.name==="45度弯头"&&(e.num-=1),e.name==="50管"&&(e.num-=1),e.name==="内50软管"&&(e.num-=1),e.name==="6型号盖"&&(e.num-=1),e.name==="3.0矿泉水桶"&&(e.num-=1),e.name==="3.0吸管"&&(e.num-=1)}),y.data.setter(l.value)),t.value.data.unshift(t.value.form)),a==="upd"){const e=t.value.index;e>=0&&t.value.data.splice(e,1,t.value.form)}t.value.show=!1,y.orderData.setter(t.value.data),t.value.form={},d()},J=(a,e)=>{t.value.type="upd",t.value.index=e,t.value.form={...a},t.value.show=!0},R=a=>{t.value.data.splice(a,1),y.orderData.setter(t.value.data),d()},z=()=>{y.data.getter()&&(l.value=y.data.getter()),l.value.some(a=>a.name==="风扇")||l.value.push({name:"风扇",num:0,warnNum:2}),l.value.some(a=>a.name==="塑料盒")||l.value.push({name:"塑料盒",num:0,warnNum:5}),l.value.some(a=>a.name==="钢丝软管")||l.value.push({name:"钢丝软管",num:0,warnNum:4}),l.value.some(a=>a.name==="直法兰")||l.value.push({name:"直法兰",num:0,warnNum:2}),l.value.some(a=>a.name==="2.0包装箱")||l.value.push({name:"2.0包装箱",num:0,warnNum:2}),l.value.some(a=>a.name==="2.0饮料瓶")||l.value.push({name:"2.0饮料瓶",num:0,warnNum:2}),l.value.some(a=>a.name==="花瓶")||l.value.push({name:"花瓶",num:0,warnNum:1}),l.value.some(a=>a.name==="90度弯头")||l.value.push({name:"90度弯头",num:0,warnNum:3}),l.value.some(a=>a.name==="45度弯头")||l.value.push({name:"45度弯头",num:0,warnNum:1}),l.value.some(a=>a.name==="50管")||l.value.push({name:"50管",num:0,warnNum:1}),l.value.some(a=>a.name==="内50软管")||l.value.push({name:"内50软管",num:0,warnNum:1}),l.value.some(a=>a.name==="6型号盖")||l.value.push({name:"6型号盖",num:0,warnNum:1}),l.value.some(a=>a.name==="3.0矿泉水桶")||l.value.push({name:"3.0矿泉水桶",num:0,warnNum:1}),l.value.some(a=>a.name==="3.0吸管")||l.value.push({name:"3.0吸管",num:0,warnNum:1}),y.orderData.getter()&&(t.value.data=oe(y.orderData.getter(),"desc","orderDate")),d()};return z(),(a,e)=>{const c=r("el-input-number"),i=r("el-button"),P=r("van-cell"),E=r("van-button"),W=r("van-swipe-cell"),A=r("van-cell-group"),F=r("el-radio-button"),X=r("el-radio-group"),G=r("van-field"),K=r("el-switch"),O=r("van-popup"),Q=r("el-input");return p(),h(V,null,[w("div",se,[w("div",re,[(p(!0),h(V,null,T(l.value,o=>(p(),h("div",{class:"shadow BR5",key:o.index,style:te([$.value(o),{width:"44%",margin:"1%",padding:"2%"}])},[w("h4",de,C(o.name),1),n(c,{class:"MT6 W100",disabled:!v.value,modelValue:o.num,"onUpdate:modelValue":g=>o.num=g,min:0,max:1e4},null,8,["disabled","modelValue","onUpdate:modelValue"]),v.value?(p(),B(c,{key:0,class:"MT6 W100",modelValue:o.warnNum,"onUpdate:modelValue":g=>o.warnNum=g,min:0,max:1e4},null,8,["modelValue","onUpdate:modelValue"])):k("",!0)],4))),128))]),v.value?(p(),h("div",me,[n(i,{type:"success",style:{flex:"1"},onClick:e[0]||(e[0]=o=>m(l.value,"备料"))},{default:s(()=>[...e[11]||(e[11]=[D("复制备料数据",-1)])]),_:1}),n(i,{type:"success",style:{flex:"1"},onClick:e[1]||(e[1]=o=>m(t.value.data,"订单"))},{default:s(()=>[...e[12]||(e[12]=[D("复制订单数据",-1)])]),_:1})])):k("",!0),v.value?(p(),h("div",ve,[n(i,{type:"primary",style:{flex:"1"},onClick:e[2]||(e[2]=o=>_("备料"))},{default:s(()=>[...e[13]||(e[13]=[D("导入备料数据",-1)])]),_:1}),n(i,{type:"primary",style:{flex:"1"},onClick:e[3]||(e[3]=o=>_("订单"))},{default:s(()=>[...e[14]||(e[14]=[D("导入订单数据",-1)])]),_:1})])):k("",!0),n(i,{style:{width:"98%",margin:"20px 1%"},size:"large",type:v.value?"primary":"success",onClick:U},{default:s(()=>[D(C(v.value?"保存":"调整"),1)]),_:1},8,["type"]),w("div",ie,[w("div",pe,[(p(!0),h(V,null,T(t.value.monthData,o=>(p(),h("div",{key:o.month,class:"shadow M6 P6 bolder",style:{color:"#727781"}},[w("div",fe,C(o.month),1),w("div",ce,C(o.value),1)]))),128))]),n(A,null,{default:s(()=>[n(P,{value:`合计 ${Y.value}`},{title:s(()=>[n(i,{size:"small",type:"primary",plain:"",onClick:e[4]||(e[4]=o=>t.value.show=!0)},{default:s(()=>[...e[15]||(e[15]=[D("新增",-1)])]),_:1})]),_:1},8,["value"]),(p(!0),h(V,null,T(t.value.data,(o,g)=>(p(),B(W,{key:g},{right:s(()=>[n(E,{square:"",type:"primary",style:{height:"100%"},text:"编辑",onClick:Z=>J(o,g)},null,8,["onClick"]),n(E,{square:"",type:"danger",style:{height:"100%"},text:"删除",onClick:Z=>R(g)},null,8,["onClick"])]),default:s(()=>[n(P,{title:`${t.value.data.length-g}：吸尘器${o.title}`,label:o.orderDate,value:`收入 ${o.value}`},null,8,["title","label","value"])]),_:2},1024))),128))]),_:1})])]),e[18]||(e[18]=w("div",{style:{height:"25vh"}},null,-1)),n(O,{show:t.value.show,"onUpdate:show":e[8]||(e[8]=o=>t.value.show=o),position:"bottom","destroy-on-close":""},{default:s(()=>[w("div",we,[n(X,{modelValue:t.value.form.title,"onUpdate:modelValue":e[5]||(e[5]=o=>t.value.form.title=o),class:"MB15",onChange:M},{default:s(()=>[n(F,{label:"2.0",value:"2.0"}),n(F,{label:"3.0",value:"3.0"})]),_:1},8,["modelValue"]),n(G,{modelValue:t.value.form.value,"onUpdate:modelValue":e[6]||(e[6]=o=>t.value.form.value=o),type:"digit",placeholder:"收入",clearable:""},null,8,["modelValue"]),n(ue,{class:"MT15",placeholder:"下单日期","default-date":t.value.form.orderDate,onDateChange:S},null,8,["default-date"]),t.value.type==="add"?(p(),B(K,{key:0,modelValue:f.value,"onUpdate:modelValue":e[7]||(e[7]=o=>f.value=o),"active-text":"计算备料",class:"MT15"},null,8,["modelValue"])):k("",!0),n(i,{type:"primary",size:"large",style:{width:"100%"},onClick:H,class:"MT50",disabled:!(t.value.form.title&&t.value.form.value)},{default:s(()=>[...e[16]||(e[16]=[D(" 提交 ",-1)])]),_:1},8,["disabled"])])]),_:1},8,["show"]),n(O,{show:u.value.show,"onUpdate:show":e[10]||(e[10]=o=>u.value.show=o),position:"bottom","destroy-on-close":""},{default:s(()=>[w("div",ye,[n(Q,{modelValue:u.value.dataStr,"onUpdate:modelValue":e[9]||(e[9]=o=>u.value.dataStr=o),placeholder:`请导入${u.value.placeholder}数据`,rows:6,type:"textarea"},null,8,["modelValue","placeholder"]),n(i,{type:"primary",size:"large",style:{width:"100%"},onClick:x,class:"MT50",disabled:!u.value.dataStr},{default:s(()=>[...e[17]||(e[17]=[D(" 提交 ",-1)])]),_:1},8,["disabled"])])]),_:1},8,["show"])],64)}}}),De=q(he,[["__scopeId","data-v-f2f6a7bc"]]);export{De as default};
